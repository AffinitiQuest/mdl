import { hex } from 'buffer-tag';
import { DeviceResponseVerifier } from '../src/index';

export const ISSUER_CERTIFICATE = `-----BEGIN CERTIFICATE-----
MIICKjCCAdCgAwIBAgIUV8bM0wi95D7KN0TyqHE42ru4hOgwCgYIKoZIzj0EAwIw
UzELMAkGA1UEBhMCVVMxETAPBgNVBAgMCE5ldyBZb3JrMQ8wDQYDVQQHDAZBbGJh
bnkxDzANBgNVBAoMBk5ZIERNVjEPMA0GA1UECwwGTlkgRE1WMB4XDTIzMDkxNDE0
NTUxOFoXDTMzMDkxMTE0NTUxOFowUzELMAkGA1UEBhMCVVMxETAPBgNVBAgMCE5l
dyBZb3JrMQ8wDQYDVQQHDAZBbGJhbnkxDzANBgNVBAoMBk5ZIERNVjEPMA0GA1UE
CwwGTlkgRE1WMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiTwtg0eQbcbNabf2
Nq9L/VM/lhhPCq2s0Qgw2kRx29tgrBcNHPxTT64tnc1Ij3dH/fl42SXqMenpCDw4
K6ntU6OBgTB/MB0GA1UdDgQWBBSrbS4DuR1JIkAzj7zK3v2TM+r2xzAfBgNVHSME
GDAWgBSrbS4DuR1JIkAzj7zK3v2TM+r2xzAPBgNVHRMBAf8EBTADAQH/MCwGCWCG
SAGG+EIBDQQfFh1PcGVuU1NMIEdlbmVyYXRlZCBDZXJ0aWZpY2F0ZTAKBggqhkjO
PQQDAgNIADBFAiAJ/Qyrl7A+ePZOdNfc7ohmjEdqCvxaos6//gfTvncuqQIhANo4
q8mKCA9J8k/+zh//yKbN1bLAtdqPx7dnrDqV3Lg+
-----END CERTIFICATE-----`;

describe('cred1', () => {
  const ephemeralReaderKey = hex`534b526561646572`;
  const encodedSessionTranscript = hex`d818589e83f6f68466313233343536782b437131616e506238765a55356a354330643768637362754a4c4270496177554a4944515269324562776234785c687474703a2f2f6c6f63616c686f73743a343030302f6170692f70726573656e746174696f6e5f726571756573742f64633839393964662d643665612d346338342d393938352d3337613862383161383265632f63616c6c6261636b6761626364656667`;
  const deviceResponse = hex`b900036776657273696f6e63312e3069646f63756d656e747381b9000367646f6354797065756f72672e69736f2e31383031332e352e312e6d444c6c6973737565725369676e6564b900026a6e616d65537061636573b90001716f72672e69736f2e31383031332e352e318cd8185867b90004686469676573744944006672616e646f6d5820a6a182d3baf6e90507d5710abfa537416679c328154707f0bbd9fefc417d3a1771656c656d656e744964656e7469666965726b66616d696c795f6e616d656c656c656d656e7456616c756565536d697468d8185865b90004686469676573744944016672616e646f6d58203ae228f1bfff5aee82c6baa5da06fd114d0a93f64451b6e4b40adbfd4901947571656c656d656e744964656e7469666965726a676976656e5f6e616d656c656c656d656e7456616c7565644a6f686ed818586eb90004686469676573744944026672616e646f6d58202157e816410ee448dc2c006780097a412012b725c4e5200cce4ba47e7532059f71656c656d656e744964656e7469666965726a62697274685f646174656c656c656d656e7456616c7565d903ec6a313938302d30362d3135d818586eb90004686469676573744944036672616e646f6d5820be02cb0f31003a7cedf36dea141cd0ef312afec75defd9148aba12cbcbb7679671656c656d656e744964656e7469666965726a69737375655f646174656c656c656d656e7456616c7565d903ec6a323032332d30332d3031d818586fb90004686469676573744944046672616e646f6d58206c0d4aab70daa084d0b1936be3ae8f4205e38cee86a5a26432d7a3f0f450bf2c71656c656d656e744964656e7469666965726b6578706972795f646174656c656c656d656e7456616c7565d903ec6a323032382d30332d3331d8185868b90004686469676573744944056672616e646f6d582050bf7b3b9199734e42eec9bb908b4635a03a8e7737d9750343f005bea72d1e9071656c656d656e744964656e7469666965726f69737375696e675f636f756e7472796c656c656d656e7456616c7565625553d818586eb90004686469676573744944066672616e646f6d58200c8e0966d9b6b29523abaae015f3d58df257cf59b4c6f71e61843d35099546b271656c656d656e744964656e7469666965727169737375696e675f617574686f726974796c656c656d656e7456616c7565664e5920444d56d8185873b90004686469676573744944076672616e646f6d5820b274831850f76bb8feb0f12870dacb8e6f65b434323d659b44e550c1bca4903071656c656d656e744964656e7469666965727469737375696e675f6a7572697364696374696f6e6c656c656d656e7456616c7565684e657720596f726bd8185871b90004686469676573744944086672616e646f6d582083a61a096c272e34c5a43f4b763d32bd17675b255e2ca67ff6670b687366196571656c656d656e744964656e7469666965726f646f63756d656e745f6e756d6265726c656c656d656e7456616c75656b30312d3333332d37303730d8185863b90004686469676573744944096672616e646f6d5820ee7d39dc24811c374fc07a833b1bf07117dda3a1b824677888b9f00a6cdd925b71656c656d656e744964656e74696669657268706f7274726169746c656c656d656e7456616c75656462737472d81858b1b900046864696765737449440a6672616e646f6d5820a9db12001b0d41429b1fa570693cedcb60437c966122f1b1a8d25b217877776771656c656d656e744964656e7469666965727264726976696e675f70726976696c656765736c656c656d656e7456616c756581b900037576656869636c655f63617465676f72795f636f646561436a69737375655f646174656a323032332d30332d30316b6578706972795f646174656a323032382d30332d3331d818587ab900046864696765737449440b6672616e646f6d582018f05297e46e3727a123276011b5ff50ac934b6569a3fb9a26c0e5d17e6a976871656c656d656e744964656e74696669657276756e5f64697374696e6775697368696e675f7369676e6c656c656d656e7456616c75656d7462642d75732e6e792e646d766a697373756572417574688443a10126a20442313118218159022e3082022a308201d0a003020102021457c6ccd308bde43eca3744f2a87138dabbb884e8300a06082a8648ce3d0403023053310b30090603550406130255533111300f06035504080c084e657720596f726b310f300d06035504070c06416c62616e79310f300d060355040a0c064e5920444d56310f300d060355040b0c064e5920444d56301e170d3233303931343134353531385a170d3333303931313134353531385a3053310b30090603550406130255533111300f06035504080c084e657720596f726b310f300d06035504070c06416c62616e79310f300d060355040a0c064e5920444d56310f300d060355040b0c064e5920444d563059301306072a8648ce3d020106082a8648ce3d03010703420004893c2d8347906dc6cd69b7f636af4bfd533f96184f0aadacd10830da4471dbdb60ac170d1cfc534fae2d9dcd488f7747fdf978d925ea31e9e9083c382ba9ed53a38181307f301d0603551d0e04160414ab6d2e03b91d492240338fbccadefd9333eaf6c7301f0603551d23041830168014ab6d2e03b91d492240338fbccadefd9333eaf6c7300f0603551d130101ff040530030101ff302c06096086480186f842010d041f161d4f70656e53534c2047656e657261746564204365727469666963617465300a06082a8648ce3d0403020348003045022009fd0cab97b03e78f64e74d7dcee88668c476a0afc5aa2cebffe07d3be772ea9022100da38abc98a080f49f24ffece1fffc8a6cdd5b2c0b5da8fc7b767ac3a95dcb83e590319d818590314b900066776657273696f6e63312e306f646967657374416c676f726974686d675348412d3235366c76616c756544696765737473b900026f6f72672e637573746f6d2e74657374a10058201a60f849c9bb73bf1b3ffcaad5befdca0205adf0ff9d30501928df473639b384716f72672e69736f2e31383031332e352e31ac0058208ff0e8d30207568b58fce0245be7fda3c2c43bed6223e269099d39622411ef050158208de89101e57f5849125f419caa949eb4335fea9aafc863b0da75521d16d087400258207d91865a151c5522f9df0d6aff3bb0d198218c4ad6f60588c8025e1ba93a32c703582079d1bc15a5171cab42390bbd941296c355236f5351090d19b5fd6833b1d57b780458204366b74cbcf9efc92ffdecb195c9d4c2e958660ea605b8ac14e2a771a0efb95a055820f294e5e7cd55c843ef8b698a7a357b2199f035c592c8ca5c3ae462d34ef5f4ca065820c74ac2ff1a237333ad2f26a3020503fb160513317daf703cda953cc3e973d07d0758209019711a369d182dccff1c58a77e019f7b6dc2b4d1e134c341b20cb1de748220085820369d5fd2e78e0982393723a69422a7bf3a8675de13ba844710104083d689d10409582097e96f88e26889c02daba71beff83745d85d03c765b665be3d47205369ed6c980a5820a66ffc3e4326346a364a18cb15d31ff745453a7b7d0693a5bf2a02c9f1a3ce970b58203725d815fb6764cf605da1a66f09c44d73ec33783bfff6f0fabacac447b2e6706d6465766963654b6579496e666fb90001696465766963654b6579a40102215820881879ca7a238b19bf0f4c1f8c00e9a2e19ba7a6f73eae92b851d4de1b508559225820a314b538039127b5cd50735f54519e33c134450545c5603ad9f263facc56d377200167646f6354797065756f72672e69736f2e31383031332e352e312e6d444c6c76616c6964697479496e666fb90003667369676e6564c074323032332d30392d32365431323a30323a34325a6976616c696446726f6dc074323032332d30392d32365431323a30323a34325a6a76616c6964556e74696cc074323032332d30392d32365431373a30323a34325a584041e17d00181ca5a448514188d261399e2037fbb69f80d9e4036eaf59079f96fa14d99217f96eda612aa5e57c7540629b3a3a4b66d8d996da95a65ca2ce9bb39c6c6465766963655369676e6564b900026a6e616d65537061636573d81843b900006a64657669636541757468b900016f6465766963655369676e61747572658443a10126a10442313158d4d81858d0847444657669636541757468656e7469636174696f6e83f6f68466313233343536782b437131616e506238765a55356a354330643768637362754a4c4270496177554a4944515269324562776234785c687474703a2f2f6c6f63616c686f73743a343030302f6170692f70726573656e746174696f6e5f726571756573742f64633839393964662d643665612d346338342d393938352d3337613862383161383265632f63616c6c6261636b6761626364656667756f72672e69736f2e31383031332e352e312e6d444cd81843b900005840cd367eeff5154fad72baca955d09da8930c345c4ccadec15bd25ee2c381f391643cf192327d2e9b54f797bb349c9aeabfaa86a629e60266daee019bc54626cc06673746174757300`;
  it('should verify properly', async () => {
    const verifier = new DeviceResponseVerifier([ISSUER_CERTIFICATE]);
    await verifier.verify(deviceResponse, {
      ephemeralReaderKey,
      encodedSessionTranscript,
    });
  });
});
